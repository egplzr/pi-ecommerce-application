<!DOCTYPE html>
<html lang="pt-br" xmlns:th="http://www.thymeleaf.org">
<div th:fragment="content">
  <h2>Meus Pedidos</h2>
  <table class="table">
    <thead><tr>
      <th># Pedido</th><th>Data</th><th>Total</th><th>Status</th><th>Ações</th>
    </tr></thead>
    <tbody id="listaPedidos"></tbody>
  </table>
</div>

<div th:fragment="scripts">
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const tbody = document.getElementById('listaPedidos');
      const pedido = JSON.parse(localStorage.getItem('pedido'));
      if (pedido) {
        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td>${pedido.numero || '-'}</td>
          <td>${pedido.data
            ? new Date(pedido.data).toLocaleDateString()
            : new Date().toLocaleDateString()}</td>
          <td>R$ ${pedido.total.toFixed(2)}</td>
          <td>${pedido.status || 'Pendente'}</td>
          <td>
            <a href="/loja/pedidos/${pedido.numero}" class="btn btn-sm btn-primary">
              Detalhes
            </a>
          </td>`;
        tbody.appendChild(tr);
      }
    });
  </script>
</div>

</html>
